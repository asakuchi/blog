{"componentChunkName":"component---src-templates-blog-post-js","path":"/rust/wasm/","result":{"data":{"site":{"siteMetadata":{"title":"あさくちブログ"}},"markdownRemark":{"id":"3642350e-32d0-5d6d-a71b-7e88ba09bfb9","excerpt":"初めての WebAssemby Rust でプロジェクト作る 以下のような内容 https://github.com/asakuchi/hello-wasm ビルド npm に公開 JavaScript から呼び出す ※練習では npm に公開したけれど、実際に使うときは npm…","html":"<h1>初めての WebAssemby</h1>\n<h2>Rust でプロジェクト作る</h2>\n<p>以下のような内容</p>\n<p><a href=\"https://github.com/asakuchi/hello-wasm\">https://github.com/asakuchi/hello-wasm</a></p>\n<p>ビルド</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">wasm-pack build <span class=\"token parameter variable\">--scope</span> mynpmusername</code></pre></div>\n<p>npm に公開</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">cd</span> pkg\n<span class=\"token function\">npm</span> publish <span class=\"token parameter variable\">--access</span><span class=\"token operator\">=</span>public</code></pre></div>\n<h2>JavaScript から呼び出す</h2>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> <span class=\"token function\">add</span> @asakuchi/hello-wasm</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> module <span class=\"token operator\">=</span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"@asakuchi/hello-wasm\"</span><span class=\"token punctuation\">)</span>\n\nmodule<span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">js</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  js<span class=\"token punctuation\">.</span><span class=\"token function\">greet</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"WebAssembly\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>※練習では npm に公開したけれど、実際に使うときは npm に公開しないでローカルのパスを指定するのかも。\n最適化したい部分だけを Rust にするなら再利用性とかなさそうだし、それを npm に公開してもしょうがないよね、と今は思う。</p>\n<p>ローカルを読み込むなら下のような感じで。</p>\n<p>package.json</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">  <span class=\"token property\">\"dependencies\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"hello-wasm\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"file:../pkg\"</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n<p>参考：<a href=\"https://developer.mozilla.org/ja/docs/WebAssembly/Rust_to_wasm\">https://developer.mozilla.org/ja/docs/WebAssembly/Rust_to_wasm</a></p>","frontmatter":{"title":"初めてのWebAssembly","date":"November 21, 2021","description":null}},"previous":{"fields":{"slug":"/database/mysql/mysql-cheat-seat/"},"frontmatter":{"title":"MySQL チートシート"}},"next":{"fields":{"slug":"/rust/wasm-test-error/"},"frontmatter":{"title":"wasm-pack test でエラー"}}},"pageContext":{"id":"3642350e-32d0-5d6d-a71b-7e88ba09bfb9","previousPostId":"ec0b54e0-5187-5381-97a0-39119c0f80d0","nextPostId":"5ca4adbf-02e2-5985-98de-3b4d2f39295d"}},"staticQueryHashes":["2841359383","3257411868"],"slicesMap":{}}